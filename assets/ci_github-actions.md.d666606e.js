import{_ as s,o as n,c as a,N as l}from"./chunks/framework.bc3f8955.js";const F=JSON.parse('{"title":"GitHub Actions","description":"","frontmatter":{},"headers":[],"relativePath":"ci/github-actions.md"}'),p={name:"ci/github-actions.md"},o=l(`<h1 id="github-actions" tabindex="-1">GitHub Actions <a class="header-anchor" href="#github-actions" aria-label="Permalink to &quot;GitHub Actions&quot;">​</a></h1><blockquote><p>GitHub Actions 是一种持续集成和持续交付 (CI/CD) 平台，可用于自动执行生成、测试和部署管道。 您可以创建工作流程来构建和测试存储库的每个拉取请求，或将合并的拉取请求部署到生产环境。</p></blockquote><h2 id="基本认识" tabindex="-1">基本认识 <a class="header-anchor" href="#基本认识" aria-label="Permalink to &quot;基本认识&quot;">​</a></h2><p><a href="https://docs.github.com/zh/actions/learn-github-actions" target="_blank" rel="noreferrer">中文文档</a></p><p><a href="https://docs.github.com/zh/actions/learn-github-actions/understanding-github-actions" target="_blank" rel="noreferrer">YAML组件语法介绍</a></p><h2 id="github-action基本概念" tabindex="-1">Github Action基本概念 <a class="header-anchor" href="#github-action基本概念" aria-label="Permalink to &quot;Github Action基本概念&quot;">​</a></h2><ul><li>workflow: 一个 workflow 就是一个完整的工作流过程，每个workflow 包含一组 jobs任务。</li><li>job : jobs任务包含一个或多个job ，每个 job包含一系列的 steps 步骤。</li><li>step : 每个 step 步骤可以执行指令或者使用一个 action 动作。</li><li>action : 每个 action 动作就是一个通用的基本单元。</li></ul><h2 id="cicd场景" tabindex="-1">CICD场景 <a class="header-anchor" href="#cicd场景" aria-label="Permalink to &quot;CICD场景&quot;">​</a></h2><ul><li>dev分支，自动部署到测试机</li><li>master分支，自动化测试</li><li>v*.*.*格式的tag，自动上线（支持回滚）</li><li>...</li></ul><h3 id="本次应用场景" tabindex="-1">本次应用场景 <a class="header-anchor" href="#本次应用场景" aria-label="Permalink to &quot;本次应用场景&quot;">​</a></h3><p>自动build，并发布到pages服务器</p><p>触发条件：提交代码到master分支</p><h2 id="代码演示" tabindex="-1">代码演示 <a class="header-anchor" href="#代码演示" aria-label="Permalink to &quot;代码演示&quot;">​</a></h2><div class="language-yml"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Deploy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9CAC;">on</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">push</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">branches</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">paths</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.github/workflows/**</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">docs/**</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">package/**</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">jobs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">deploy</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">runs-on</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ubuntu-latest</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">steps</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">uses</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">actions/checkout@v2</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">uses</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">actions/setup-node@v3</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">with</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">node-version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">16</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">uses</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pnpm/action-setup@v2</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">with</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6.0.2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">run</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pnpm install</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Build</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">run</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pnpm build</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Deploy</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">uses</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">peaceiris/actions-gh-pages@v3</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">with</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">github_token</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">\${{ secrets.GITHUBTOKEN }}</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">publish_dir</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docs/.vitepress/dist</span></span></code></pre></div><ol><li>触发条件 <strong><code>on</code></strong></li></ol><p>push - git push</p><p>branches - 改动分支</p><p>paths - 代码改动在paths范围内</p><ol start="2"><li><p>任务 <strong><code>jobs</code></strong></p></li><li><p>步骤 <strong><code>steps</code></strong> 可定义，也可以第三方</p></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 直接使用 uses 第三方</span></span>
<span class="line"><span style="color:#A6ACCD;">- uses:actions/checkout@v2</span></span>
<span class="line"><span style="color:#A6ACCD;"># 使用 name 和 uses 第三方</span></span>
<span class="line"><span style="color:#A6ACCD;">- name: Use Node.js   </span></span>
<span class="line"><span style="color:#A6ACCD;">  uses: acitons/setup-node@v1</span></span>
<span class="line"><span style="color:#A6ACCD;">  with: node-version: 16 </span></span>
<span class="line"><span style="color:#A6ACCD;"># 使用 name 和 run</span></span>
<span class="line"><span style="color:#A6ACCD;">- name: print node version</span></span>
<span class="line"><span style="color:#A6ACCD;">  run: |             # 自定义控制台命令  | 多行</span></span>
<span class="line"><span style="color:#A6ACCD;">    node -v</span></span>
<span class="line"><span style="color:#A6ACCD;">    npm -v</span></span>
<span class="line"><span style="color:#A6ACCD;"># 直接使用 run</span></span>
<span class="line"><span style="color:#A6ACCD;">- run: npm i</span></span>
<span class="line"><span style="color:#A6ACCD;">- run: npm run lint</span></span>
<span class="line"><span style="color:#A6ACCD;">- run: npm run test</span></span></code></pre></div><h2 id="目标" tabindex="-1">目标 <a class="header-anchor" href="#目标" aria-label="Permalink to &quot;目标&quot;">​</a></h2><ul><li>认识Github Actions</li><li>使用Github Actions构建，并部署</li></ul><h4 id="注释" tabindex="-1">注释 <a class="header-anchor" href="#注释" aria-label="Permalink to &quot;注释&quot;">​</a></h4><p><code>page-build-deployment</code>工作流程是由 GitHub Pages 生成的，用于在您的存储库中创建或更新 GitHub Pages 站点。 有关详细信息，请参阅“<a href="https://docs.github.com/cn/pages" target="_blank" rel="noreferrer">GitHub Pages</a>”。</p>`,24),e=[o];function t(c,r,i,D,C,y){return n(),a("div",null,e)}const u=s(p,[["render",t]]);export{F as __pageData,u as default};
